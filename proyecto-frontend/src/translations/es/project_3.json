{
    "h1": "Clustering - Seguros",
    "t1": "Aprendizaje no supervisado: K-means",
    "p1": "En este proyecto realizaremos un procedimiento muy parecido al proyecto anterior (Clustering - Countries), pero en lugar de obtener perfiles de países, obtendremos perfiles de asegurados. \n \nAunque el análisis de los países nos ha servido para exponer el funcionamiento del algoritmo k-means, ahora intentaremos aplicarlo en un caso más ligado al ámbito empresarial. En este caso obtendremos perfiles de asegurados en base a una serie de características, pero de forma similar se puede aplicar para obtener perfiles de productos (en base a sus ventas), perfiles de clientes (en base a sus compras), perfiles de meses (en base a los ingresos), perfiles de empleados (en base a su rendimiento)… \n \nCentrémonos en nuestro caso. Los datos que utilizaremos hacen referencia a los clientes de una empresa de seguros de automóviles, concretamente disponemos de los siguientes datos: \n \npoliza: Identificador de póliza. \n \nsexo: Génerodel cliente asegurado. \n \nsri: Situación de riesgo o zona de circulación urbana o no urbana. \n \ngdi: Contratada garantía de daños propios o no. \n \nsin: Número de siniestros en el año analizado. \n \nant_comp: Antigüedad del cliente en la compañía (en años). Lo llamaremos fidelidad. \n \nant_perm: Antigüedad del permiso de conducir del asegurado (en años). Lo llamaremos experiencia. \n \nedad: Edad del asegurado (en años). \n \nant_veh: Antigüedad del vehículo asegurado (en años). \n \nTodos estos datos hacen referencia a un periodo de un año.",
    "a1": {
        "p": "Empezamos, como siempre, definiendo el directorio de trabajo y cargando los datos ('Datos_analisis_clusters.csv').",
        "c": "#Definimos directorio de trabajo y cargamos los datos \n \nsetwd(“ruta”) \nCartera <- read.table('Datos_analisis_clusters.csv', head=TRUE, sep=';'')"
    },
    "p2": "Una vez cargados los datos, en la variable 'Cartera', vamos a intentar entenderlos mejor a partir de una serie de visualizaciones.",
    "i1": "Visualizamos los 6 primeros registros a modo de ejemplo. \n \nknitr::kable(head(Cartera))",
    "a2": {
        "p": "De todas las variables de que disponemos, nos quedaremos sólo con las 5 variables numéricas: número de siniestros, fidelidad, experiencia, edad y antigüedad del vehículo.",
        "c": "#Seleccionamos las 5 variables numéricas con las que realizaremos el análisis \n \nclus<-Cartera[,c('sin','ant_comp','ant_perm','edad','ant_veh')]"
    },
    "i2": "Visualizamos los 6 primeros registros a modo de ejemplo. \n \nknitr::kable(head(clus))",
    "i3": "Visualizamos los principales estadísticos (mínimo, máximo, media…) de cada una de nuestras variables (columnas). \n \nknitr::kable(summary(clus))",
    "i4": "Visualizamos, en una tabla, el número de clientes en función del número de siniestros que han tenido durante el periodo de análisis. Vemos, como es lógico, que la gran mayoría de clientes no ha tenido ningún siniestro. \n \nfreq<-table(Cartera$sin) \n \nfreq",
    "i5": "Visualizamos los mismos datos, pero esta vez en forma de un gráfico de barras. \n \nbarplot(freq,xlab='Número de siniestros', ylab='Frecuencia') \ntitle(main='Número de siniestros', col.main='blue', font.main=1)",
    "i6": "Visualizamos, en un gráfico de barras, el número de clientes en función de su género. \n \nbarplot(table(Cartera$Sexo), xlab='Genero', ylab='Frecuencia') \ntitle(main='Genero', col.main='blue', font.main=1)",
    "i7": "Visualizamos, en un gráfico de barras, el número de clientes en función de su fidelidad (años que llevan en la compañía). \n \nbarplot(table(Cartera$ant_comp), xlab='Fidelidad', ylab='Frecuencia') \ntitle(main='Fidelidad', col.main='blue', font.main=1)",
    "i8": "Visualizamos, en un gráfico de barras, el número de clientes en función de su experiencia (antigüedad del carnet de conducir). \n \nbarplot(table(Cartera$ant_perm), xlab='Experiencia', ylab='Frecuencia') \ntitle(main='Experiencia', col.main='blue', font.main=1)",
    "i9": "Visualizamos, en un gráfico de barras, el número de clientes en función de su edad. \n \nbarplot(table(Cartera$edad), xlab='Edad', ylab='Frecuencia') \ntitle(main='Edad', col.main='blue', font.main=1)",
    "i10": "Visualizamos, en un gráfico de barras, el número de clientes en función de la antigüedad de su vehículo. \n \nbarplot(table(Cartera$ant_veh), xlab='Antiguedad Vehiculo', ylab='Frecuencia') \ntitle(main='Antiguedad Vehiculo', col.main='blue', font.main=1)",
    "a3": {
        "p": "Ahora ya nos hemos hecho una idea más o menos clara de nuestros datos, pero antes de aplicar el algoritmo k-means tenemos que normalizar los datos.",
        "c": "#Normalizamos las variables \n \nclus_norm<-clus \n \nclus_norm[,c('sin')] <- (clus$sin-mean(clus$sin))/sd(clus$sin) \nclus_norm[,c('ant_comp')] <- (clus$ant_comp-mean(clus$ant_comp))/sd(clus$ant_comp) \nclus_norm[,c('ant_perm')] <- (clus$ant_perm-mean(clus$ant_perm))/sd(clus$ant_perm) \nclus_norm[,c('edad')] <- (clus$edad-mean(clus$edad))/sd(clus$edad) \nclus_norm[,c('ant_veh')] <- (clus$ant_veh-mean(clus$ant_veh))/sd(clus$ant_veh)"
    },
    "a4": {
        "p": "Todo listo, pero antes de aplicar el algoritmo k-means tenemos que decidir el número de clusters. ¿Cuál será el valor más adecuado? ¿En cuántos clusters o grupos deberíamos segmentar los asegurados? \n \nPara decidir el número de clusters utilizaremos la suma de cuadrados entre grupos o 'betweenss'. Recordemos que la situación ideal es obtener unos clusters en que los asegurados que pertenecen a un mismo cluster sean lo más homogéneos (parecidos) posible y que los asegurados que pertenecen a clusters diferentes sean lo más heterogéneos (diferentes) posible. En pocas palabras, buscamos maximizar 'betweenss' (la distancia entre clusters).",
        "c": "#Calculamos 'betweenss' \n \nset.seed(123) \nbss <- kmeans(clus_norm,centers=1)$betweenss \n for (i in 2:10) bss[i] <- kmeans(clus_norm,centers=i)$betweenss"
    },
    "i11": "Visualizamos la suma de cuadrados entre grupos (betweenss) en función del número de grupos. \n \nplot(1:10, bss, type='l', xlab='Número de grupos', ylab='Sumas de cuadrados entre grupos')",
    "p3": "En base al gráfico de betweenss, el número de clusters más óptimo para segmentar estos datos parece ser 5, al tratarse del máximo relativo más pronunciado. Por otro lado, 7 también parece ser un valor interesante.",
    "a5": {
        "p": "Ahora sí, aplicamos el algoritmo k-means fijando el número de clusters en 5.",
        "c": "#K-means \n \nclus_kmeans=clus \nNumCluster=5 \nset.seed(123) \nModelo=kmeans(clus_norm,NumCluster) \nclus_kmeans$clusterKmeans= Modelo$cluster"
    },
    "i12": "Visualizamos, para cada uno de los 5 grupos que hemos creado, la media de las diferentes variables. \n \nknitr::kable(aggregate(.~clusterKmeans,FUN=mean, data=clus_kmeans), 'simple')",
    "i13": "Visualizamos, para cada uno de los 5 grupos que hemos creado, el número de individuos clasificados en ese grupo. \n \ntable(clus_kmeans$clusterKmeans)",
    "p4": "Tanto el cluster 2 como el cluster 5 agrupan a los asegurados más jóvenes, con poca experiencia (antigüedad del permiso de conducir) y con poca fidelidad (tiempo que llevan en la compañía), pero difieren tanto en cuanto a la siniestralidad como en cuanto a la antigüedad del vehículo. Los individuos del cluster 5 se caracterizan por llevar coches viejos y por tener una siniestralidad baja. Los individuos del cluster 2 se caracterizan por llevar coches nuevos y por tener una siniestralidad alta (aproximadamente el doble que los individuos del cluster 5). \n \nLo que los datos nos están indicando es que existen 2 perfiles de clientes dentro de los asegurados más jóvenes: unos con vehículos nuevos y otros con vehículos antiguos, y que los que tienen vehículos nuevos suelen tener el doble de siniestros (de media). Digamos que los vehículos nuevos ofrecen más y mejores prestaciones en cuanto a seguridad, pero también permiten correr más, y lo segundo parece ser más relevante que lo primero. \n \nTanto el cluster 3 como el cluster 4 agrupan a los asegurados de mayor edad, con más experiencia (antigüedad del permiso de conducir) y con poca fidelidad (tiempo que llevan en la compañía), pero difieren tanto en cuanto a la siniestralidad como en cuanto a la antigüedad del vehículo. Los individuos del cluster 4 se caracterizan por llevar coches viejos y por tener una siniestralidad baja (de hecho, es el cluster con menor siniestralidad). Los individuos del cluster 3 se caracterizan por llevar coches nuevos y por tener una siniestralidad alta (de hecho, es el cluster con mayor siniestralidad, aproximadamente el triple que el cluster 4). \n \nEn resumen, en el caso de los clusters 3 y 4 nos volvemos a encontrar con algo muy parecido a lo que nos hemos encontrado en el caso de los clusters 2 y 5, pero de forma aún más pronunciada: los asegurados de mayor edad que tienen vehículos nuevos suelen tener el triple de siniestros que los asegurados de mayor edad que tienen vehículos antiguos. \n \nPor último, el cluster 1 agrupa a los asegurados con mayor fidelidad (los que llevan más tiempo en la compañía). De forma lógica, los asegurados que llevan más tiempo en la compañía, suelen tener una edad y una experiencia elevadas. Por otro lado, se trata de individuos con unos vehículos de una antigüedad media (o más bien que agrupa tanto a individuos con vehículos nuevos como individuos con vehículos viejos). Y por último, su nivel de siniestralidad es más bien bajo."
}